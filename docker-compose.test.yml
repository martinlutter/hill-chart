services:
  e2e:
    image: mcr.microsoft.com/playwright:v1.58.2-noble
    working_dir: /app
    volumes:
      # Mount source â€” changes are reflected immediately
      - .:/app
      # Separate named volume for node_modules to avoid host/container platform conflicts
      - e2e_node_modules:/app/node_modules
    command: bash -c 'PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1 npm ci --silent'
    # Required for Chrome's shared memory usage inside Docker
    ipc: host

volumes:
  e2e_node_modules:
